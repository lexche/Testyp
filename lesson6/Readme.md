## Урок 6. Файловые системы.

Представим: данные лежат на диске в “сыром” виде. Каждой программе-процессу придётся самостоятельно придумывать логику работы с этим сырьём. А как при этом разделять доступ к файлам разных пользователей? А обеспечить совместимость программ? А надёжность хранения?

Файловая система - это организация файлов и данных на устройствах хранения, таких как жесткие диски, флэш-накопители, карты памяти и другие носители информации. Она отвечает за размещение и управление файлами, организацию доступа к ним и обеспечивает безопасное хранение информации. Представь, что файловая система - это своего рода "каталог" для твоих файлов, где каждый файл имеет свое место и структуру.

Теперь, почему она нужна? А вот почему: без файловых систем мы просто не смогли бы эффективно хранить и находить данные, а также не смогли бы управлять файлами на наших устройствах.

Когда ты сохраняешь файл на компьютере или мобильном устройстве, файловая система помогает разместить его на диске, а затем позволяет нам находить, открывать и изменять этот файл. Без файловой системы все данные были бы как беспорядочная куча информации, и найти нужную информацию было бы как поиск иголки в стоге сена. Файловая система дает структуру этой информации и делает ее доступной для нас.

Так что файловая система - это наша главная система организации данных на компьютерах и других устройствах, и без нее работа с данными была бы какой-то беспорядок.

Есть большое количество файловых систем, рассмотрим основные из них:

- FAT (File Allocation Table)
  Ключевые характеристики:
  - Простая структура с использованием таблицы файловой выделения (FAT), для отслеживания расположения файлов на диске.
  - Поддерживается многими операционными системами.
  - Используется на съемных носителях, таких как флэш-накопители, SD-карты и др.
  - Однако, ограничена в поддержке файлов размером более 4 ГБ и не так эффективна как более современные файловые системы.

- NTFS (New Technology File System)
  Ключевые характеристики:
  - Разработана корпорацией Microsoft и является стандартной файловой системой для операционных систем семейства Windows.
  - Поддерживает метаданные, журналирование, расширенные права доступа и файловые системы большого размера.
  - Предлагает высокую надежность и защиту данных.

- ext4 (Fourth Extended Filesystem)
 Ключевые характеристики:
  - Является одной из самых популярных файловых систем в среде Linux.
  - Активно использует журналирование для повышения надежности.
  - Поддерживает большие файлы и тома.
  - Предоставляет высокую производительность и надежность.

- APFS (Apple File System)
 Ключевые характеристики:
  - Разработана компанией Apple для их операционных систем, таких как macOS, iOS, watchOS и tvOS.
  - Поддерживает криптографическое шифрование, клонирование файлов и снимки файловой системы для быстрого восстановления.
  - Обеспечивает оптимизацию для SSD и флэш-накопителей.

- ZFS (Zettabyte File System)
 Ключевые характеристики:
  - Ориентирована на обеспечение высокой отказоустойчивости и устойчивости к повреждениям данных.
  - Поддерживает расширенные возможности управления данными, такие как снимки, клонирование, восстановление после сбоев и автоматическое исправление ошибок.

Каждая файловая система имеет свои особенности и применение в зависимости от целей использования и требований к надежности и производительности. Понимание особенностей этих файловых систем помогает выбрать наиболее подходящий вариант для конкретного применения.

В файловых системах данные организованы с помощью нескольких ключевых принципов, которые обеспечивают эффективное управление файлами и папками. Давай рассмотрим основные принципы:

1. Иерархическая структура
Файловые системы организованы в виде иерархии, похожей на дерево, в котором узлы представляют папки (каталоги), а листья - файлы. Это организационное устройство облегчает структурирование данных и помогает пользователям легко найти нужные файлы.

2. Индексирование и адресация
Каждый файл в файловой системе имеет свой уникальный адрес или индекс, который обеспечивает быстрый доступ к данным. Это позволяет операционной системе быстро находить и обращаться к файлам, даже когда на диске много других файлов.

3. Метаданные
Метаданные представляют собой информацию о файлах и папках, такую как имя, размер, даты создания и изменения, права доступа и местоположение на диске. Файловая система хранит эти метаданные в специальных областях на носителе данных, что помогает операционной системе управлять файлами и контролировать доступ к ним.

4. Управление свободным пространством
Файловая система отслеживает, какие блоки данных заняты, а какие свободны. Это позволяет осуществлять размещение новых файлов и управлять изменениями в существующих файлах.

5. Журналирование
Некоторые файловые системы поддерживают журналирование, что позволяет вести отслеживание всех изменений, сделанных в файловой системе. Этот метод повышает надежность и целостность файловой системы, так как при сбое операционной системы можно восстановить состояние файловой системы с помощью журнала.

## Квиз

Вопрос 1
Характеристика: Поддержка многих операционных систем
Ответ: Обе файловые системы

И в FAT32, и в NTFS есть поддержка многих операционных систем. Однако, NTFS в основном используется в операционных системах Windows, в то время как FAT32 поддерживается многими операционными системами, включая Windows, macOS и многие дистрибутивы Linux.

Вопрос 2
Характеристика: Подходит для съемных носителей, таких как флэш-накопители, SD-карты
Ответ: FAT32

FAT32 часто используется на съемных устройствах, таких как флэш-накопители и SD-карты, потому что она обладает хорошей совместимостью с различными операционными системами и может быть удобно использована для обмена файлами между разными устройствами.

Вопрос 3
Характеристика: Поддержка файлов большого размера и объемов томов
Ответ: NTFS

NTFS имеет поддержку файлов и объемов томов больших размеров, что делает ее более подходящей для хранения крупных файлов и работы с большими накопителями данных, чем FAT32.

Вопрос 4
Характеристика: Разработана корпорацией Microsoft
Ответ: NTFS

NTFS была разработана корпорацией Microsoft. Она является стандартной файловой системой для операционных систем семейства Windows и предлагает расширенные возможности по сравнению с более старой файловой системой FAT32.

Разберём несколько механизмов файловой системы, чтобы лучше понять как она работает:

- Индексация. Индексация в файловой системе представляет собой механизм организации данных, облегчающий доступ к файлам на диске путем создания структуры данных, которая ускоряет процесс поиска и обращения к файлам.

Принципы работы

1. Создание индексов: При создании или изменении файловой системы, операционная система создает индексы для файлов, содержащие метаданные, такие как имена файлов, их местоположение, время создания, размер и другие атрибуты.
   
2. Ускоренный доступ: Используя эти индексы, операционная система может быстро находить нужные файлы, обращаться к ним, выполнять поиск и фильтрацию, не обязательно просматривая каждый сектор диска в поисках конкретного файла.

3. Поддержка поиска по различным критериям: Индексы позволяют операционной системе выполнять поиск файлов по различным критериям, таким как имя файла, дата создания, тип файла и другие атрибуты, ускоряя процесс обработки пользовательских запросов.

Индексация ускоряет процесс поиска файлов, особенно на больших дисках, что делает доступ к данным более эффективным и удобным. Благодаря индексам, операционная система может извлекать информацию о файлах в соответствии с различными критериями, что увеличивает гибкость в доступе к данным. Индексация также может потреблять дополнительные ресурсы, такие как место на диске для хранения индексов и вычислительные ресурсы для поддержания и обновления этих индексов.

- Размещение файлов. Размещение файлов - это ключевой механизм файловой системы, который определяет, как файлы физически размещаются на диске, чтобы обеспечить эффективное и оптимальное использование пространства и быстрый доступ к данным.

Принципы работы

1. Выделение места на диске: При создании нового файла или при копировании существующего, файловая система должна решить, в каких секторах диска этот файл будет храниться.

2. Обеспечение непрерывности данных: Файловая система должна обеспечить такое размещение файлов, чтобы данные сохранялись непрерывно. Это улучшает производительность, поскольку обеспечивает более быстрый доступ к данным на диске.

3. Эффективное использоание пространства: При размещении файлов файловая система стремится использовать пространство на диске максимально эффективно, чтобы избежать фрагментации и уменьшения производительности.

- Управление свободным пространством. Так же помогает эффективно использовать место на диске. ### Отслеживание доступных блоков данных

Файловая система отслеживает, какие блоки данных на диске свободны, и ведет учет их доступности для использования новыми файлами или для расширения существующих.
В процессе создания, изменения и удаления файлов, дисковая структура может стать фрагментированной, что означает, что файлы распределены в несмежные блоки на диске. Управление свободным пространством включает в себя процессы уплотнения данных, которые целью имеют облегчить доступ и улучшить производительность.
Файловая система должна принимать решения о том, какие блоки данных использовать для новых файлов. Это включает в себя аллокацию сквозных блоков для больших файлов, управление индексами для быстрого доступа к свободному пространству и распределение блоков данных эффективным образом.
Управление свободным пространством также связано с оптимизацией доступа, включая предвзятый выбор блоков данных для улучшения скорости доступа к файлам и сокращение фрагментации.
Эффективное управление свободным пространством важно для производительности файловой системы, так как это обеспечивает оптимальное использование дискового пространства, снижает фрагментацию данных и обеспечивает быстрый доступ к файлам.
