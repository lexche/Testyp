## Урок 4. Протоколы доступа к данным


Мы собрали хранилище, теперь нужно предоставить к нему доступ. К локальным дискам на сервере не нужно настраивать какой-то специальный доступ. Но для централизованной системы хранения нужны специальные протоколы. Есть набор таких протоколов, о некоторых мы уже рассказывали в прошлых уроках. Для этих целей есть 2 вида протоколов: блочные (FCP  (Fibre Channel Protocol), iSCSI) и файловые: SMB, NFS.

#### Блочные протоколы данных

Блочные протоколы данных - это протоколы, которые управляют доступом к данным на низком уровне, позволяя чтение и запись данных в виде фиксированных блоков фиксированного размера на устройствах хранения. Они оперируют на уровне устройства хранения, не имея представления о структуре файловой системы.  Примеры:

1. iSCSI (Internet Small Computer System Interface):
   - Описание: iSCSI - это протокол передачи блочных данных по сети TCP/IP. Он позволяет устройствам хранения данных, таким как серверы или хранилища, предоставлять удаленным клиентам доступ к блочным данным через IP-сеть.
   - Преимущества:
     - Гибкость: Использование сети TCP/IP позволяет использовать существующую сетевую инфраструктуру без необходимости в дополнительном оборудовании.
     - Управление: Протокол iSCSI поддерживает функции управления, такие как обнаружение устройств, и управление качеством обслуживания (QoS), что обеспечивает гибкость в настройке.
   - Недостатки:
     - Производительность: Использование сети TCP/IP может сказаться на производительности в сравнении с более специализированными сетевыми технологиями, такими как Fibre Channel.
     - Безопасность: Требуется обеспечить безопасность передачи данных по открытым сетям.

2. Fibre Channel Protocol (FCP):
   - Описание: Протокол Fibre Channel (FC) - это высокоскоростной протокол передачи данных, который обычно используется в SAN (Storage Area Network). Протокол FCP является одним из протоколов, используемых в Fibre Channel, который позволяет устройствам хранения данных обмениваться блочными данными в SAN.
   - Преимущества:
     - Производительность: Fibre Channel обеспечивает высокую скорость передачи данных и низкую задержку, что делает его привлекательным для приложений с высокими требованиями к производительности.
     - Надежность: Fibre Channel предоставляет механизмы проверки целостности данных и обеспечивает высокую надежность передачи данных.
   - Недостатки:
     - Сложность: Развёртывание и управление сетями Fibre Channel может потребовать дополнительной экспертизы и специализированного оборудования, что может повысить затраты на поддержку.

В целом, iSCSI и Fibre Channel Protocol предоставляют разные подходы к передаче блочных данных. iSCSI обеспечивает гибкость и простоту настройки за счёт использования сети TCP/IP, в то время как Fibre Channel обеспечивает высокую производительность и надежность за счёт специализированной инфраструктуры. Выбор между ними зависит от конкретных требований к производительности, надёжности и затратам на обслуживание.

#### Файловые протоколы данных

Файловые протоколы данных - это протоколы, которые управляют доступом к данным на уровне файловой системы, позволяя организовывать данные в виде файлов и каталогов. Они обеспечивают абстракцию над блочными устройствами, предоставляя удобный способ организации, доступа и управления данными. Примеры файловых протоколов данных включают NTFS (для Windows), ext4 (для Linux), APFS (для macOS) и т. д.

1. SMB (Server Message Block):
   - Описание: Протокол SMB является одним из самых популярных файловых протоколов и используется для обмена файлами и принтерами между устройствами в сети. Он разработан Microsoft и широко применяется в Windows-среде.
   - Преимущества:
     - Мультиплатформенность: Поддерживается не только Windows, но и другими операционными системами, такими как Linux или macOS.
     - Простота настройки: Легко настраивается и обеспечивает удобный способ обмена файлами в гетерогенных сетях.
   - Недостатки:
     - Ограничения безопасности: Могут возникнуть вопросы безопасности при несоблюдении соответствующих мер защиты данных.

2. NFS (Network File System):
   - Описание: Протокол NFS предоставляет возможность удаленного доступа к файловым системам через сеть. Он наиболее часто ассоциируется с UNIX-подобными операционными системами, но также поддерживается в других ОС.
   - Преимущества:
     - Производительность: NFS обеспечивает относительно высокую производительность при доступе к файлам по сети.
     - Расширяемость: Позволяет масштабировать доступ к файловой системе для множества клиентов.
   - Недостатки:
     - Сложность настройки: Настройка и конфигурация NFS может требовать дополнительных шагов по сравнению с SMB.
     - Совместимость: Могут возникнуть проблемы совместимости при взаимодействии с различными операционными системами.

Итак, как SMB, так и NFS являются широко используемыми файловыми протоколами для обмена данными в сети. SMB обычно используется в Windows-среде, в то время как NFS чаще связан с UNIX-подобными системами. Выбор между ними, как и всегда, зависит от конкретных требований, потребностей и особенностей среды вашей сети.

### Квиз

1. Какой протокол обеспечивает передачу блочных данных в сети хранения SAN через специальное оборудование?
   - A) NFS
   - B) SMB
   - C) iSCSI
   - D) Fibre Channel Protocol
   - Правильный ответ: D) Fibre Channel Protocol используется для передачи блочных данных в сетях хранения SAN через специальное оборудование Fibre Channel.
  
2. Какой протокол обеспечивает доступ к файлам и каталогам на удалённом сервере?
   - A) iSCSI
   - B) Fibre Channel Protocol
   - C) NFS
   - D) SMB
   - Правильный ответ: C) NFS (Network File System) предоставляет возможность доступа к файлам и каталогам на удалённом сервере.

3. Какой протокол обычно используется для подключения блочных устройств хранения, таких как диски или тома, к удалённым серверам?
   - A) SMB
   - B) iSCSI
   - C) NFS
   - D) Fibre Channel Protocol
   - Правильный ответ: B) iSCSI часто используется для подключения блочных устройств хранения к удалённым серверам через сеть TCP/IP.

4.  Какой из протоколов обеспечивает доступ к файлам и принтерам в сетях Windows?
   - A) NFS
   - B) iSCSI
   - C) Fibre Channel Protocol
   - D) SMB
     Правильный ответ: D) SMB (Server Message Block) используется для обмена файлами и принтерами в сетях Windows.


Давайте сравним блочные протоколы (на примере iSCSI) и файловые протоколы (на примере NFS) по нескольким критериям:

1. Модель данных:
   - Блочные протоколы (iSCSI): Передают блоки данных между устройствами, обрабатывая их как наборы байтов без знания о структуре файловой системы.
   - Файловые протоколы (NFS): Предоставляют доступ к файлам и каталогам в файловой системе, позволяя клиентам монтировать удалённые ресурсы как часть своей локальной файловой системы.

2. Уровень абстракции:
   - Блочные протоколы (iSCSI): Работают на уровне блоков данных, не имея информации о структуре файлов.
   - Файловые протоколы (NFS): Предоставляют более высокий уровень абстракции, позволяя клиентам видеть файлы и каталоги как локальные объекты.

3. Применение:
   - Блочные протоколы (iSCSI): Часто используются для предоставления удалённого блочного доступа к устройствам хранения данных, таким как диски и тома.
   - Файловые протоколы (NFS): Часто применяются для обмена файлами и ресурсами в сетевых средах, обеспечивая удалённый доступ к файлам и каталогам.

4. Гибкость:
   - Блочные протоколы (iSCSI): Обычно более гибкие и могут использоваться для различных целей, включая формирование виртуальных томов и кластеризацию.
   - Файловые протоколы (NFS): Предоставляют доступ к файлам и каталогам, что может быть удобно для обмена данными, но менее гибко в некоторых сценариях, таких как работа с блочными устройствами.

5. Производительность:
   - Блочные протоколы (iSCSI): Обычно обеспечивают более высокую производительность для операций чтения/записи блоков данных.
   - Файловые протоколы (NFS): Могут иметь некоторые ограничения в производительности из-за работы с файлами и каталогами на более высоком уровне абстракции.

В целом, блочные протоколы, такие как iSCSI, обычно используются для работы с низкоуровневыми блочными устройствами хранения, в то время как файловые протоколы, такие как NFS, предназначены для обмена файлами и каталогами в сети. Выбор между ними зависит от конкретных требований вашей среды и предпочтений в области управления данными.


В блочных протоколах, таких как iSCSI, и файловых протоколах, например NFS, безопасность играет важную роль для защиты данных от несанкционированного доступа и модификации. Вот как обеспечивается безопасность в обоих случаях:

Блочные протоколы (например, iSCSI):

1. Аутентификация и авторизация: iSCSI обычно использует механизмы аутентификации на уровне CHAP (Challenge Handshake Authentication Protocol) или Kerberos для проверки подлинности и авторизации устройств и пользователей.

2. Шифрование данных: Для обеспечения конфиденциальности данных в транспорте могут использоваться протоколы шифрования, такие как IPsec или SSL/TLS.

3. Контроль доступа: iSCSI может использовать механизмы контроля доступа, такие как ACL (списки управления доступом), чтобы определить, кто и как может получать доступ к ресурсам хранения.

4. Аудит и журналирование: Для отслеживания действий пользователей и обеспечения целостности данных могут использоваться механизмы аудита и журналирования.

Файловые протоколы (например, NFS):

1. Аутентификация и авторизация: NFS может использовать механизмы аутентификации, такие как Kerberos или RPCSEC_GSS, для проверки подлинности клиентов и серверов и авторизации доступа к файлам и каталогам.

2. Шифрование данных: Для защиты данных в пути между клиентами и серверами NFS можно использовать протоколы шифрования, такие как IPsec или SSL/TLS.

3. Контроль доступа: NFS поддерживает механизмы контроля доступа, такие как ACL (списки управления доступом) и права доступа к файлам и каталогам, чтобы регулировать доступ к данным.

4. Аудит и журналирование: Подобно блочным протоколам, NFS может вести журнал действий пользователей и обеспечивать механизмы аудита для обеспечения целостности и безопасности данных.

В обоих случаях безопасность реализуется через комбинацию аутентификации, авторизации, шифрования данных, контроля доступа и механизмов аудита, чтобы обеспечить защиту данных от угроз. Конкретные методы и настройки безопасности могут различаться в зависимости от конфигурации и требований конкретной среды.

### Квиз

1. Какой из следующих протоколов передачи данных является блочным?

a) ISCSI

b) NFS

c) HTTP

d) SMTP

Правильный ответ: a) ISCSI предназначен для передачи блочных данных, в то время как NFS - файловый протокол, предназначенный для передачи файлов.

2. Какой механизм аутентификации поддерживается протоколом ISCSI?

a) Kerberos

b) CHAP

c) SSH

d) SNMP

Правильный ответ: b) ISCSI поддерживает механизм аутентификации CHAP, который позволяет проверить подлинность участников сеанса передачи данных.

3. Какой протокол предоставляет возможность контроля доступа к данным?

a) ISCSI

b) NFS

c) DNS

d) HTTP

Правильный ответ: b) NFS предоставляет механизмы контроля доступа, которые позволяют ограничивать доступ к ресурсам и управлять правами доступа к данным.

4. Какой протокол предоставляет возможность аудита доступа к данным?

a) ISCSI

b) NFS

c) FTP

d) SNMP

Правильный ответ: b) NFS предоставляет возможность аудита, которая позволяет отслеживать доступ к данным и события, связанные с передачей файлов.

5. Какой протокол передачи данных более подходит для передачи больших блоков данных между серверами?

a) ISCSI

b) NFS

c) HTTP

d) SMTP

Правильный ответ: a) ISCSI является блочным протоколом и лучше подходит для передачи больших блоков данных между серверами, в то время как NFS - файловый протокол для передачи файлов.

В этом уроке вы узнал, что протоколы доступа к данным бывают блочные и файловые. Рассмотрели самые распространённые протоколы каждого типа, в чём отличия этих типов протоколов, узнали как у блочных протоколов (на примере, ISCSi) и у файловых протоков (на примере NFS) реализован подход к безопасности.

В следующем уроке подробно расскажм про протокол NFS.
