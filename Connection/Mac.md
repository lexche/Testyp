## Подключение к учебной инфраструктуре

### Установка ПО

Начнём со скачивания и установки необходимого для подключения программного обеспечения:

1. В MacOS есть встроенный клиент для подключения с помощью SSH, но мы воспользуемся программой Termius, так как она даёт возможность сохранять хосты, к которым вы постоянно подключаетесь, не вводя каждый раз всю информацию о подключении.

Откройте AppStore и введите в строке поиска Termius.

![M01](https://github.com/lexche/Testyp/assets/95694325/0bded744-9b71-4089-9d22-fc1887c1f23a)

Установите это приложение и закрепите его в Dock.

2. Tailscale - это современное средство для создания приватных сетей (VPN) с использованием современных принципов безопасности и удобства. Он предоставляет простой способ соединить различные устройства и сети, позволяя им обмениваться данными и ресурсами, будучи при этом защищенным на уровне шифрования и аутентификации.

Дистрибутив доступен по ссылке: https://sysadmin.education-services.ru/downloads/Tailscale-1.58.2-macos.zip

Скачиваем архив:

![M02](https://github.com/lexche/Testyp/assets/95694325/9b438292-0241-4985-9414-d473ef902ed2)

Разархивируем

![M03](https://github.com/lexche/Testyp/assets/95694325/abfba67c-6311-444c-afcd-67d5e8077d7b)

Разархивированное приложение перетаскиваем в папку Applications (Приложения):

![M04](https://github.com/lexche/Testyp/assets/95694325/ea6b4c5b-5cdf-4895-b484-41476cf6d015)

Запускаем. После запуска появится окно, нажимаем Open (Открыть):

![M05](https://github.com/lexche/Testyp/assets/95694325/c32892ab-51aa-4fef-9b5c-58b2ab308e27)

И снова Open (Открыть):

![M06](https://github.com/lexche/Testyp/assets/95694325/d790e299-4df4-4a2f-8f85-3c37ee6e0346)

В открывшемся окне раскрываем (кликаем ) замок в нижнем левом углу, если запросит пароль, вводите:

![M07](https://github.com/lexche/Testyp/assets/95694325/d2025a30-9e0f-45d5-805d-ffb0f8e22334)

Нажмите на кнопку Allow (Разрешить):

![M08](https://github.com/lexche/Testyp/assets/95694325/224da309-b302-488c-9e0e-bde2b966dbde)

Ещё раз Allow (Разрешить): 

![M09](https://github.com/lexche/Testyp/assets/95694325/5690b056-5f91-4c58-8029-1ad35945fed0)

После этого у вас должен появиться значок программы в поле уведомлений, она пока не настроена, об этом пойдёт речь дальше:

![M10](https://github.com/lexche/Testyp/assets/95694325/ce50cfab-865e-413f-a1cb-60fcade44d5e)

### Настройка доступа

Открываем встроенный терминал, он находится в папке Applications (Приложения) подпапка Utilities (Утилиты):

![M11](https://github.com/lexche/Testyp/assets/95694325/226c5f2e-1573-4199-802b-4c822e92ee7e)

Terminal (Терминал), можете закрепить его в Docks, может пригодиться :

![M12](https://github.com/lexche/Testyp/assets/95694325/c8702e02-1140-45a9-880d-28348e40f5c4)

В открывшемся окне вводим следующую команду и Enter :

```
alias tailscale="/Applications/Tailscale.app/Contents/MacOS/Tailscale"
```

![M13](https://github.com/lexche/Testyp/assets/95694325/2602c1f9-7d33-4b26-a372-ad39ddf5799f)

После этого вводите команду и Enter:

```
tailscale login --shields-up --accept-routes --login-server https://vpn.sysadmin.education-services.ru
```
В ответ будет выдана ссылка, которую нужно скопировать и вставить в браузер, либо вы будете сразу перенаправлены в браузер:

![M14](https://github.com/lexche/Testyp/assets/95694325/2f67f3d4-d650-4854-bddb-00588e4da0a2)

При переходе по ссылке вам будет предложено ввести логин и пароль, которые вым выдали ранее, введите их:

![M15](https://github.com/lexche/Testyp/assets/95694325/2f5e83a2-8dc4-48a3-892b-01e742154515)


Далее вы увидите окно:

![M16](https://github.com/lexche/Testyp/assets/95694325/b75be510-4824-461b-93a0-67eab9adfc32)


В нём говорится, что необходимо установить одно из приложений на выбор на сотовый телефон для получения одноразовых паролей, так как для подключения к инфраструктуре используется двухфакторная аутентификация. Для примера мы будем использовать приложение FreeOTP, так оно выглядит в appstore: 

![M17](https://github.com/lexche/Testyp/assets/95694325/bada8678-d9f5-4de5-ba34-340e2a09771f)


Заходим в приложение, жмём на иконку Qr-code'а, если запросит разрешение на использование камеры, разрешаем, направляем на Qr-code, который высветился на сайте авторизации:

![M18](https://github.com/lexche/Testyp/assets/95694325/fe8c6a14-7b7c-414e-b4bf-170847b26c4f)


После этого в приложении создастся токен для вашей учётной записи, который будет генерировать случайные одноразовые пароли:

![M19](https://github.com/lexche/Testyp/assets/95694325/fa963c8b-0555-44aa-a4ba-c613e8390202)


А сайт пропустит дальше, предложив ввести одноразовый пароль и имя устройство. Одноразовый пароль берём из приложения, имя устройство придумываем самостоятельно, нажимаем Submit:

![M20](https://github.com/lexche/Testyp/assets/95694325/c9e6eaf5-cd02-4158-a43a-3ea259f0fb2c)


Если всё хорошо, то вы увидите такую надпись, сайт можно закрывать:

![M21](https://github.com/lexche/Testyp/assets/95694325/7e59161a-db65-4aab-86ca-e8843141b1dc)

Tailscale посде этого подключится автоматически, в дальнейшем для подключения\отключения нажимайте соответствующий ползунок:

При переходе по ссылке вам будет предложено ввести логин и пароль, которые вым выдали ранее, введите их:

![W15](https://github.com/lexche/Testyp/assets/95694325/db9e9556-95bc-4acf-9d3b-9f71990dd49f)

Далее вы увидите окно:

![W16](https://github.com/lexche/Testyp/assets/95694325/d6114ed0-060f-424d-b5ad-ee4c19632ce3)

В нём говорится, что необходимо установить одно из приложений на выбор на сотовый телефон для получения одноразовых паролей, так как для подключения к инфраструктуре используется двухфакторная аутентификация. Для примера мы будем использовать приложение FreeOTP, так оно выглядит в appstore: 

![W17](https://github.com/lexche/Testyp/assets/95694325/1e7e6350-7586-43e8-b871-be9f83418422)

Заходим в приложение, жмём на иконку Qr-code'а, если запросит разрешение на использование камеры, разрешаем, направляем на Qr-code, который высветился на сайте авторизации:

![W18](https://github.com/lexche/Testyp/assets/95694325/88562be4-c5ae-4df0-891d-72c4767fb73f)

После этого в приложении создастся токен для вашей учётной записи, который будет генерировать случайные одноразовые пароли:

![W19](https://github.com/lexche/Testyp/assets/95694325/b52569fd-e543-4b88-9860-d0d47e9f4e1c)

А сайт пропустит дальше, предложив ввести одноразовый пароль и имя устройство. Одноразовый пароль берём из приложения, имя устройство придумываем самостоятельно, нажимаем Submit:

![W20](https://github.com/lexche/Testyp/assets/95694325/d5f1fdf4-ea55-477a-8ff7-f29355808204)

Если всё хорошо, то вы увидите такую надпись, сайт можно закрывать:

![W21](https://github.com/lexche/Testyp/assets/95694325/c59b4885-bf6f-4060-b1ce-3d7e56df21d5)

Открываем Terminus, нажимаем на кнопку New Host:

![M23](https://github.com/lexche/Testyp/assets/95694325/f2dfd4ae-7a33-4264-82f7-725c4a93c824)

Заполняем поля как показано на рисунке. В графе адрес, вставьте: cloudshell.sysadmin.local.

![M24](https://github.com/lexche/Testyp/assets/95694325/f0f9244f-1726-4bd1-b332-33c3caab795b)

Самые умные из вас, возможно, ввели и пароль, но напрасно, так как этот пароль состоит из 2х частей: пароль, который вам выдали и пароль из мобильного приложения, записать их нужно в таком формате: ваш пароль/одноразовый пароль из приложения, не спешите при вводе, проверьте раскладку, сохранять пароль не нужно, так как он булет меняться:

![M25](https://github.com/lexche/Testyp/assets/95694325/41b01f32-76da-4894-97b2-2d01835bfe41)

Если вы ввели всё верно, то вы увидите примерно следующее:

![M26](https://github.com/lexche/Testyp/assets/95694325/03d616fc-89d0-4f28-9dcf-0c428c540c45)

Добро пожаловать. Успехов!

