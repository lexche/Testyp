# Урок 7. Сетевые устройства

В предыдущих уроках вы познакомились со всеми уровнями модели TCP/IP — данные в ней обрастают заголовками, как снежный ком. Самое время познакомиться с сетевым оборудованием, которое использует сетевые протоколы для передачи данных. В рамках этого урока мы рассмотрим основные типы сетевого оборудования: коммутатор (свитч, хаб), маршрутизатор (он же роутер) и межсетевой экран (фаервол).


## Коммутатор

Коммутатор соединяет устройства в одной сети (как компьютеры в офисе или ваши устройства дома). Он знает, какое устройство подключено к какому порту, и отправляет информацию только туда, куда нужно. Если совсем упростить, то коммутатор - это как многопортовый удлинитель для интернета. Он берёт интернет из одного места (например, из роутера) и раздаёт его сразу нескольким устройствам (компьютерам, принтерам, телевизорам) в вашей сети.


Представьте многоквартирный дом. Коммутатор - это почтальон внутри этого дома. Он знает, в какую квартиру нужно доставить каждое письмо и не разносит его всем подряд. Он знает, что "Компьютер А" живет в квартире "Порт 1", а "Компьютер Б" - в квартире "Порт 2".

Коммутаторы различаются по многим параметрам, в рамках этого урока мы расскажем про основные типы коммутаторов, но не про все, чтобы вас не напугать и хватило времени рассказать про маршрутизаторы и межсетевые экраны.



## Маршрутизатор

![]()

>[На подложке: a2c0c5] Ещё одно устройство, знакомое по прошлым урокам. Напомним, что маршрутизатор отличается от коммутатора тем, что работает на межсетевом уровне и служит для пересылки IP пакетов между разными сетями.

Для выполнения своих задач он использует **таблицу маршрутизации**, которая содержит соответствие IP-адресов и интерфейсов, через которые нужно отправить пакет. 

Представим, что у нас есть сеть:


![]()


И в ней — две разные подсети: `192.168.1.0/24` и `192.168.2.0/24`. В таком случае таблица на маршрутизаторе будет выглядеть следующим образом:

```c
Назначение        Шлюз             Маска            Интерфейс
192.168.1.0/24     -                255.255.255.0    eth0
192.168.2.0/24     -                255.255.255.0    eth1
```

Когда пакет из первой подсети попадёт на маршрутизатор, запустится алгоритм:

1. Из заголовка пакета извлечётся IP-адрес назначения.

2. Затем маршрутизатор применит к нему маску (вспомните [урок про IP-протокол](https://practicum.yandex.ru/learn/sys-admin/courses/422bcc9f-26c0-4cff-ba43-ca6dd8626b47/sprints/null/topics/017e3a39-b526-42b5-8e7c-49a344ef3b45/lessons/18a85191-cd27-4527-b84c-ebe14c01d742/)).

3. И сравнит полученный результат с адресом из записи в таблице маршрутизации.

4. Если адреса совпадут, маршрутизатор выберет интерфейс, через который нужно отправить пакет.

>[На подложке] Пакет, отправленный с ПК 1 с адресом `192.168.1.7`, придёт на маршрутизатор через интерфейс `eth 0`. Адрес его назначения — `192.168.2.4` с маской `24`, то есть ПК 2. 
>
> После наложения маски получится нужная подсеть `192.168.2.0/24`, маршрутизатор сверится с таблицей и отправит пакет на интерфейс `eth1`.

Есть ещё один важный компонент:

>[На подложке: a2c0c5] Для операций по маршрутизации предназначен специальный аппаратный модуль — **ASIC** (от англ. Application-Specific Integrated Circuit — «интегральная схема для конкретного применения»). Это микросхема, которая берёт на себя часть задач и снимает нагрузку с процессора сетевого оборудования. 

ASIC оптимизирован для обработки сетевых пакетов, что значительно ускоряет его работу по сравнению с общим процессором маршрутизатора.

[Кнопка] Узнать про файрвол

## Файрвол

>[На подложке: a2c0c5] Ещё одно важное устройство в сетевой архитектуре — **межсетевые экраны** (англ. firewalls, также используется название «брандмауэр»), предназначенные для контроля и фильтрации сетевого трафика. 
>
> Они работают на аппаратном уровне и обычно используются для защиты корпоративных сетей от угроз — хакерских атак, вирусов, вредоносного ПО и других. 

>[Реплика героя курса] Конечно, есть и программные решения, но они уступают аппаратным в производительности.

![]()

Проходящий через сетевой экран трафик обрабатывается по специальным правилам — они определяют, пропускать его или нет. Обычно правило выглядит как условие и действие, которое необходимо совершить: например, при обращении к `22` порту запрещать трафик.

Есть также усовершенствованные версии файрволов с более широким спектром функций и возможностей для обеспечения безопасности сети — **NGFW** (от англ. Next-Generation Firewall — «файрвол следующего поколения»). 

Основной упор в них — не только на фильтрации пакетов и контроле доступа на уровне портов и протоколов, как у традиционных межсетевых экранов, но и на глубоком анализе сетевого трафика.

Пройдёмся по возможностям NGFW:

1. **Продвинутый контроль приложений:** способность распознавать их в сетевом трафике и применять правила безопасности на уровне приложений, а не только портов.

1. **Глубокий анализ трафика**, включая декодирование SSL-трафика, обнаружение вредоносного ПО и предотвращение передачи угрожающих файлов.

2. **Обнаружение и предотвращение атак в реальном времени**, таких как DDoS атаки, фишинг, SQL-инъекции и прочих.

### Подведём итоги

С аппаратной точки зрения сетевое оборудование задействовано на всех уровнях модели TCP/IP. Такие устройства оснащаются специальными микросхемами — у коммутаторов и маршрутизаторов это ASIC. 

Как в коммутаторах, так и в маршрутизаторах есть таблицы — CAM и маршрутизации, а ещё протоколы для борьбы с широковещательными штормами, или сетевыми петлями. Безопасность в сети обеспечивает отдельное многофункциональное устройство — межсетевой экран, или файрвол.
